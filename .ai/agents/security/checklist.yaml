# Security Agent Checklist
# Version: 1.0.0
# Last Updated: 2026-01-29
# Focus: OWASP Top 10 Security Vulnerabilities
# Reference: OWASP Top 10 2021

metadata:
  version: "1.0.0"
  language: "java"
  agent: "security"
  focus: "Security vulnerabilities and OWASP Top 10"
  owasp_reference: "https://owasp.org/Top10/"

rules:
  # =============================================================================
  # BLOCK Severity - Critical Security Issues (Prevents Commit)
  # =============================================================================

  # Category: Sensitive Data Exposure (OWASP A02:2021)
  - id: hardcoded-secret
    category: sensitive-data
    owasp: "A02:2021"
    description: "Detect hardcoded secrets, passwords, API keys, or credentials."
    severity: BLOCK

  # Category: Injection (OWASP A03:2021)
  - id: sql-injection
    category: injection
    owasp: "A03:2021"
    description: "Check for SQL queries that do not use PreparedStatement or parameterized queries."
    severity: BLOCK

  - id: command-injection
    category: injection
    owasp: "A03:2021"
    description: "Detect Runtime.exec() or ProcessBuilder with unsanitized user input."
    severity: BLOCK

  - id: path-traversal
    category: injection
    owasp: "A03:2021"
    description: "Detect file operations with unsanitized paths that could allow ../../../ traversal."
    severity: BLOCK

  - id: xxe-vulnerability
    category: injection
    owasp: "A03:2021"
    description: "Detect XML parsing without disabling external entities (XXE attacks)."
    severity: BLOCK

  # Category: Insecure Design (OWASP A04:2021)
  - id: unsafe-deserialization
    category: insecure-design
    owasp: "A08:2021"
    description: "Detect unsafe deserialization of untrusted data."
    severity: BLOCK

  # Category: Cryptographic Failures (OWASP A02:2021)
  - id: insecure-random
    category: cryptographic-failures
    owasp: "A02:2021"
    description: "Detect use of java.util.Random for security-sensitive operations instead of SecureRandom."
    severity: BLOCK

  # Category: Security Logging (OWASP A09:2021)
  - id: logging-sensitive-data
    category: logging-failures
    owasp: "A09:2021"
    description: "Detect logging of passwords, tokens, or PII that should not appear in logs."
    severity: BLOCK

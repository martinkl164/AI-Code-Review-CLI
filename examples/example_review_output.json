{
  "summary": "Found 5 critical security/correctness issues, 2 warnings, and 1 info message.",
  "issues": [
    {
      "rule_id": "hardcoded-secret",
      "severity": "BLOCK",
      "file": "examples/test.java",
      "line": "4",
      "message": "Hardcoded database password 'admin123' detected. Store credentials in environment variables or use a secure configuration management system like HashiCorp Vault or AWS Secrets Manager."
    },
    {
      "rule_id": "hardcoded-secret",
      "severity": "BLOCK",
      "file": "examples/test.java",
      "line": "5",
      "message": "Hardcoded API key detected. API keys should be stored securely in environment variables or a secrets management system, never in source code."
    },
    {
      "rule_id": "sql-injection",
      "severity": "BLOCK",
      "file": "examples/test.java",
      "line": "9",
      "message": "SQL injection vulnerability: query concatenates user input directly. Use PreparedStatement with parameterized queries: 'PreparedStatement ps = conn.prepareStatement(\"SELECT * FROM users WHERE username = ?\"); ps.setString(1, username);'"
    },
    {
      "rule_id": "npe-risk",
      "severity": "BLOCK",
      "file": "examples/test.java",
      "line": "14",
      "message": "NullPointerException risk: 'user' parameter is dereferenced without null check. Add validation: 'if (user == null || user.getName() == null) { throw new IllegalArgumentException(\"User cannot be null\"); }'"
    },
    {
      "rule_id": "thread-safety",
      "severity": "BLOCK",
      "file": "examples/test.java",
      "line": "26",
      "message": "Thread safety issue: static mutable field 'counter' is modified without synchronization. Use AtomicInteger or synchronize access: 'private static final AtomicInteger counter = new AtomicInteger(0);' and 'counter.incrementAndGet();'"
    },
    {
      "rule_id": "exception-handling",
      "severity": "WARN",
      "file": "examples/test.java",
      "line": "21",
      "message": "Empty catch block swallows exception without logging or handling. At minimum, log the exception: 'logger.error(\"Failed to read file: \" + path, e);' or rethrow as a runtime exception."
    },
    {
      "rule_id": "performance-collections",
      "severity": "WARN",
      "file": "examples/test.java",
      "line": "34",
      "message": "Inefficient collection usage: linear search through List has O(n) complexity. Consider using a Set for O(1) lookup, or use 'items.contains(target)' which is clearer and potentially optimized by the JVM."
    },
    {
      "rule_id": "naming-conventions",
      "severity": "INFO",
      "file": "examples/test.java",
      "line": "30",
      "message": "Method name 'DoSomething' violates Java naming conventions. Method names should start with lowercase: 'doSomething'. Variable 'MyVariable' should also be 'myVariable'."
    }
  ]
}
